if(typeof akeeba=="undefined"){var akeeba={}}if(typeof akeeba.Configuration=="undefined"){akeeba.Configuration={};akeeba.Configuration.engines={};akeeba.Configuration.installers={};akeeba.Configuration.URLs={};akeeba.Configuration.FtpBrowser={params:{}};akeeba.Configuration.SftpBrowser={params:{}};akeeba.Configuration.FtpTest={};akeeba.Configuration.SftpTest={};akeeba.Configuration.passwordFields={};akeeba.Configuration.fsBrowser={params:{dialogId:"folderBrowserDialog",dialogBodyId:"folderBrowserDialogBody"}}}(function($){akeeba.Configuration.parseConfigData=function(data){akeeba.Configuration.engines=data.engines;akeeba.Configuration.installers=data.installers;akeeba.Configuration.parseGuiData(data.gui)};akeeba.Configuration.parseGuiData=function(data,rootnode){if(rootnode==null){rootnode=$("#akeebagui")}rootnode.empty();var group_id=0;$.each(data,function(headertext,groupdef){group_id++;if(empty(groupdef)){return}var container=$(document.createElement("div"));container.addClass("well").appendTo(rootnode);var header=$(document.createElement("h4"));header.attr("id","auigrp_"+rootnode.attr("id")+"_"+group_id);header.html(headertext);header.appendTo(container);$.each(groupdef,function(config_key,defdata){var current_id="var["+config_key+"]";if((defdata.type!="hidden")&&(defdata.type!="none")){var row_div=$(document.createElement("div")).addClass("akeeba-ui-optionrow control-group");row_div.appendTo(container);var label=$(document.createElement("label"));label.addClass("control-label").attr("for",current_id).html(defdata.title);if(defdata.description){label.attr("rel","popover").attr("data-original-title",defdata.title).attr("data-content",defdata.description)}if(defdata.bold){label.css("font-weight","bold")}label.appendTo(row_div)}var controlWrapper=$(document.createElement("div")).addClass("controls");switch(defdata.type){case"none":break;case"hidden":var hiddenfield=$(document.createElement("input")).attr({type:"hidden",id:current_id,name:current_id,size:"40",value:defdata["default"]});hiddenfield.appendTo(container);break;case"separator":var separator=$(document.createElement("div")).addClass("akeeba_ui_separator");separator.appendTo(container);break;case"checkandhide":var span=$(document.createElement("span"));span.appendTo(controlWrapper);controlWrapper.appendTo(row_div);var hiddenfield=$(document.createElement("input")).attr({type:"hidden",id:current_id,name:current_id,size:"40",value:defdata["default"]});hiddenfield.appendTo(span);var myLabel="";if(defdata["default"]==""){myLabel=defdata.labelempty}else{myLabel=defdata.labelnotempty}var span2=$(document.createElement("span"));span2.text(myLabel).appendTo(span).data("labelempty",defdata.labelempty).data("labelnotempty",defdata.labelnotempty);break;case"installer":var editor=$(document.createElement("select")).attr({"class":"form-control",id:current_id,name:current_id});$.each(akeeba.Configuration.installers,function(key,element){var option=$(document.createElement("option")).attr("value",key).html(element.name);if(defdata["default"]==key){option.attr("selected",1)}option.appendTo(editor)});editor.appendTo(controlWrapper);controlWrapper.appendTo(row_div);break;case"engine":var engine_type=defdata.subtype;if(akeeba.Configuration.engines[engine_type]==null){break}var engine_config_container=$(document.createElement("div")).attr({id:config_key+"_config"}).addClass("hidden well").appendTo(controlWrapper);var editor=$(document.createElement("select")).attr({id:current_id,name:current_id});$.each(akeeba.Configuration.engines[engine_type],function(key,element){var option=$(document.createElement("option")).attr("value",key).html(element.information.title);if(defdata["default"]==key){option.attr("selected",1)}option.appendTo(editor)});editor.bind("change",function(e){var old_values={};$(engine_config_container).find("input").each(function(i){if($(this).attr("type")=="checkbox"){old_values[$(this).attr("id")]=$(this).is(":checked")}else{old_values[$(this).attr("id")]=$(this).val()}});var new_engine=$(this).val();var enginedef=akeeba.Configuration.engines[engine_type][new_engine];var enginetitle=enginedef.information.title;var new_data={};new_data[enginetitle]=enginedef.parameters;akeeba.Configuration.parseGuiData(new_data,engine_config_container);$(engine_config_container).find("legend:first").after($(document.createElement("p")).addClass("alert alert-info").html(enginedef.information.description));engine_config_container.find("input").each(function(i){var old=old_values[$(this).attr("id")];if((old!=null)&&(old!=undefined)){if($(this).attr("type")=="checkbox"){$(this).attr("checked",old)}else{if($(this).attr("type")=="hidden"){$(this).next().next().slider("value",old)}else{$(this).val(old)}}}});akeeba.Configuration.enablePopoverFor(engine_config_container.find('[rel="popover"]'))});var button=$(document.createElement("button")).html(Joomla.JText._("COM_AKEEBA_CONFIG_UI_CONFIG")).addClass("btn btn-mini");var icon=$(document.createElement("span")).addClass("icon-wrench").prependTo(button);button.bind("click",function(e){engine_config_container.toggleClass("hidden");e.preventDefault()});var spacerSpan=$(document.createElement("span")).html("&nbsp;");button.prependTo(controlWrapper);spacerSpan.prependTo(controlWrapper);editor.prependTo(controlWrapper);controlWrapper.appendTo(row_div);if(akeeba.Configuration.engines[engine_type][defdata["default"]]!=null){var new_engine=defdata["default"];var enginedef=akeeba.Configuration.engines[engine_type][new_engine];var enginetitle=enginedef.information.title;var new_data=new Object;var engine_params=enginedef.parameters;new_data[enginetitle]=engine_params;if(defdata["protected"]!=0){var titleSpan=$(document.createElement("span")).text(enginetitle);titleSpan.prependTo(span);editor.css("display","none")}akeeba.Configuration.parseGuiData(new_data,engine_config_container);$(engine_config_container).find("legend:first").after($(document.createElement("p")).html(enginedef.information.description))}break;case"browsedir":var editor=$(document.createElement("input")).attr({type:"text","class":"form-control",id:current_id,name:current_id,size:"30",value:defdata["default"]});var button=$(document.createElement("button")).attr("title",Joomla.JText._("COM_AKEEBA_CONFIG_UI_BROWSE")).html("&nbsp;").addClass("btn");var icon=$(document.createElement("span")).addClass("icon-folder-open").prependTo(button);button.bind("click",function(event){event.preventDefault();if(akeeba.Configuration.onBrowser!=null){akeeba.Configuration.onBrowser(editor.val(),editor)}});var span=$(document.createElement("span")).addClass("input-append");editor.appendTo(span);button.appendTo(span);span.appendTo(span);span.appendTo(controlWrapper);controlWrapper.appendTo(row_div);break;case"buttonedit":var editortype=defdata.editortype=="hidden"?"hidden":"text";var editor=$(document.createElement("input")).attr({type:editortype,id:current_id,name:current_id,size:"30",value:defdata["default"]});if(defdata.editordisabled=="1"){editor.attr("disabled","disabled")}var button=$(document.createElement("button")).html(Joomla.JText._(defdata.buttontitle)).addClass("btn");button.bind("click",function(event){event.preventDefault();var hook=defdata.hook;try{eval(hook+"()")}catch(err){}});var span=$(document.createElement("span")).addClass("input-append");editor.appendTo(span);button.appendTo(span);span.appendTo(controlWrapper);controlWrapper.appendTo(row_div);break;case"enum":var editor=$(document.createElement("select")).attr({id:current_id,name:current_id});var enumvalues=defdata.enumvalues.split("|");var enumkeys=defdata.enumkeys.split("|");$.each(enumvalues,function(counter,value){var item_description=enumkeys[counter];var option=$(document.createElement("option")).attr("value",value).html(item_description);if(value==defdata["default"]){option.attr("selected",1)}option.appendTo(editor)});editor.appendTo(controlWrapper);controlWrapper.appendTo(row_div);break;case"string":var editor=$(document.createElement("input")).attr({type:"text",id:current_id,name:current_id,size:"40",value:defdata["default"]});editor.appendTo(controlWrapper);controlWrapper.appendTo(row_div);break;case"password":akeeba.Configuration.passwordFields[current_id]=defdata["default"];var editor=$(document.createElement("input")).attr({type:"password",id:current_id,name:current_id,size:"40",value:defdata["default"],autocomplete:"off"});editor.appendTo(controlWrapper);controlWrapper.appendTo(row_div);break;case"integer":var hidden_input=$(document.createElement("input")).attr({id:config_key,name:current_id,type:"hidden"}).val(defdata["default"]);var custom=$(document.createElement("input")).attr("type","text").attr("size","10").attr("id",config_key+"_custom").css("display","none").css("margin-left","6px").addClass("input-mini");custom.blur(function(){var value=parseFloat(custom.val());value=value*defdata.scale;if(value<defdata.min){value=defdata.min}else{if(value>defdata.max){value=defdata.max}}hidden_input.val(value);var newValue=value/defdata.scale;custom.val(newValue.toFixed(2))});var dropdown=$(document.createElement("select")).attr({id:config_key+"_dropdown",name:config_key+"_dropdown"}).addClass("input-small");var enumvalues=defdata.shortcuts.split("|");var quantizer=defdata.scale;var isPresetOption=false;$.each(enumvalues,function(counter,value){var item_description=value/quantizer;var option=$(document.createElement("option")).attr("value",value).html(item_description.toFixed(2));if(value==defdata["default"]){option.attr("selected",1);isPresetOption=true}option.appendTo(dropdown)});var option=$(document.createElement("option")).attr("value",-1).html("Custom...");if(!isPresetOption){option.attr("selected",1);custom.val((defdata["default"]/defdata.scale).toFixed(2)).show()}option.appendTo(dropdown);dropdown.change(function(){var value=dropdown.val();if(value==-1){custom.val((defdata["default"]/defdata.scale).toFixed(2)).show().focus();custom.next().addClass("add-on")}else{hidden_input.val(value);custom.hide();custom.next().removeClass("add-on")}});var uom=defdata.uom;if((typeof(uom)!="string")||empty(uom)){uom="";dropdown.appendTo(controlWrapper);custom.appendTo(controlWrapper)}else{var inputAppendWrapper=$(document.createElement("div")).addClass("input-append");var label=$(document.createElement("span")).text(" "+uom);if(!isPresetOption){label.addClass("add-on")}dropdown.appendTo(inputAppendWrapper);custom.appendTo(inputAppendWrapper);label.appendTo(inputAppendWrapper);inputAppendWrapper.appendTo(controlWrapper)}hidden_input.appendTo(controlWrapper);controlWrapper.appendTo(row_div);break;case"bool":var wrap_div=$(document.createElement("div")).addClass("akeeba-ui-checkbox");$(document.createElement("input")).attr({name:current_id,type:"hidden",value:0}).appendTo(wrap_div);var editor=$(document.createElement("input")).attr({name:current_id,id:current_id,type:"checkbox",value:1});if(defdata["default"]!=0){editor.attr("checked","checked")}editor.appendTo(wrap_div);wrap_div.appendTo(controlWrapper);controlWrapper.appendTo(row_div);break;case"button":var hook=defdata.hook;var labeltext=label.html();var editor=$(document.createElement("button")).attr("id",current_id).html(labeltext).addClass("btn");label.html("&nbsp;");editor.bind("click",function(e){e.preventDefault();try{eval(hook+"()")}catch(err){}});editor.appendTo(controlWrapper);controlWrapper.appendTo(row_div);break;default:var method="akeeba_render_"+defdata.type;var fn=window[method];fn(config_key,defdata,label,row_div)}})})};akeeba.Configuration.restoreDefaultPasswords=function(){$.each(akeeba.Configuration.passwordFields,function(curid,defvalue){myElement=document.getElementById(curid);try{console.debug(curid+" => "+defvalue)}catch(e){}$(myElement).val("BROWSERS ARE BRAIN DEAD");$(myElement).val(defvalue)})};akeeba.Configuration.onBrowser=function(folder,element){akeeba.Configuration.onBrowserCallback=function(myFolder){$(element).val(myFolder);$("#"+akeeba.Configuration.fsBrowser.params.dialogId).modal("hide")};var browserSrc=akeeba.Configuration.URLs.browser+encodeURIComponent(folder);var $dialogBody=$("#"+akeeba.Configuration.fsBrowser.params.dialogBodyId);$dialogBody.html("");var iFrame=$(document.createElement("iframe")).attr({src:browserSrc,width:"100%",height:400,frameborder:0,allowtransparency:"true"});iFrame.appendTo($dialogBody);$("#"+akeeba.Configuration.fsBrowser.params.dialogId).modal("show")};akeeba.Configuration.FtpBrowser.callback=function(path){var charlist=("/").replace(/([\[\]\(\)\.\?\/\*\{\}\+\$\^\:])/g,"$1");var re=new RegExp("^["+charlist+"]+","g");path="/"+(path+"").replace(re,"");$(document.getElementById("var["+akeeba.Configuration.FtpBrowser.params.key+"]")).val(path)};akeeba.Configuration.FtpBrowser.initialise=function(key,paramsKey){akeeba.Configuration.FtpBrowser.params.host=$(document.getElementById("var["+paramsKey+".host]")).val();akeeba.Configuration.FtpBrowser.params.port=$(document.getElementById("var["+paramsKey+".port]")).val();akeeba.Configuration.FtpBrowser.params.username=$(document.getElementById("var["+paramsKey+".user]")).val();akeeba.Configuration.FtpBrowser.params.password=$(document.getElementById("var["+paramsKey+".pass]")).val();akeeba.Configuration.FtpBrowser.params.passive=$(document.getElementById("var["+paramsKey+".passive_mode]")).is(":checked");akeeba.Configuration.FtpBrowser.params.ssl=$(document.getElementById("var["+paramsKey+".ftps]")).is(":checked");akeeba.Configuration.FtpBrowser.params.directory=$(document.getElementById("var["+paramsKey+".initial_directory]")).val();akeeba.Configuration.FtpBrowser.params.key=key;akeeba.Configuration.FtpBrowser.open()};akeeba.Configuration.FtpBrowser.open=function(){var ftp_dialog_element=$("#ftpdialog");$("#ftpdialogOkButton").click(function(e){akeeba.Configuration.FtpBrowser.callback(akeeba.Configuration.FtpBrowser.params.directory);$("#ftpdialog").modal("hide")});$ftp_dialog_element.modal("show");$("#ftpBrowserErrorContainer").css("display","none");$("#ftpBrowserFolderList").html("");$("#ftpBrowserCrumbs").html("");akeeba.System.params.AjaxURL=akeeba.Configuration.URLs.ftpBrowser;if(empty(akeeba.Configuration.FtpBrowser.params.directory)){akeeba.Configuration.FtpBrowser.params.directory=""}var data={host:akeeba.Configuration.FtpBrowser.params.host,username:akeeba.Configuration.FtpBrowser.params.username,password:akeeba.Configuration.FtpBrowser.params.password,passive:(akeeba.Configuration.FtpBrowser.params.passive?1:0),ssl:(akeeba.Configuration.FtpBrowser.params.ssl?1:0),directory:akeeba.Configuration.FtpBrowser.params.directory};akeeba.System.doAjax(data,function(data){if(data.error!=false){$("#ftpBrowserError").html(data.error);$("#ftpBrowserErrorContainer").css("display","block");$("#ftpBrowserFolderList").css("display","none");$("#ak_crumbs").css("display","none")}else{$("#ftpBrowserErrorContainer").css("display","none");if(!empty(data.breadcrumbs)){$("#ak_crumbs").css("display","block");$("#ak_crumbs").html("");var relativePath="/";akeeba.Configuration.FtpBrowser.addCrumb(Joomla.JText._("COM_AKEEBA_FILEFILTERS_LABEL_UIROOT"),"/",$("#ak_crumbs"));$.each(data.breadcrumbs,function(i,crumb){relativePath+="/"+crumb;akeeba.Configuration.FtpBrowser.addCrumb(crumb,relativePath,$("#ak_crumbs"))})}else{$("#ftpBrowserCrumbs").css("display","none")}if(!empty(data.list)){$("#ftpBrowserFolderList").css("display","block");if(!akeeba.Configuration.FtpBrowser.params.directory){akeeba.Configuration.FtpBrowser.params.directory=data.directory}$.each(data.list,function(i,item){akeeba.Configuration.FtpBrowser.createLink(data.directory+"/"+item,item,$("#ftpBrowserFolderList"))})}else{$("#ftpBrowserFolderList").css("display","none")}}},function(message){$("#ftpBrowserError").html(message);$("#ftpBrowserErrorContainer").css("display","block");$("#ftpBrowserFolderList").css("display","none");$("#ftpBrowserCrumbs").css("display","none")},false)};akeeba.Configuration.FtpBrowser.createLink=function(path,label,container,ftpObject){if(typeof ftpObject=="undefined"){ftpObject=akeeba.Configuration.FtpBrowser}var row=$(document.createElement("tr"));var cell=$(document.createElement("td")).appendTo(row);var myElement=$(document.createElement("a")).text(label).click(function(){ftpObject.params.directory=path;ftpObject.open()}).appendTo(cell);row.appendTo($(container))};akeeba.Configuration.FtpBrowser.addCrumb=function(crumb,relativePath,container,ftpObject){if(typeof ftpObject=="undefined"){ftpObject=akeeba.Configuration.FtpBrowser}var li=$(document.createElement("li"));$(document.createElement("a")).html(crumb).click(function(e){ftpObject.params.directory=relativePath;ftpObject.open();e.preventDefault()}).appendTo(li);li.appendTo(container)};akeeba.Configuration.SftpBrowser.initialise=function(key,paramsKey){akeeba.Configuration.SftpBrowser.params.host=$(document.getElementById("var["+paramsKey+".host]")).val();akeeba.Configuration.SftpBrowser.params.port=$(document.getElementById("var["+paramsKey+".port]")).val();akeeba.Configuration.SftpBrowser.params.username=$(document.getElementById("var["+paramsKey+".user]")).val();akeeba.Configuration.SftpBrowser.params.password=$(document.getElementById("var["+paramsKey+".pass]")).val();akeeba.Configuration.SftpBrowser.params.directory=$(document.getElementById("var["+paramsKey+".initial_directory]")).val();akeeba.Configuration.SftpBrowser.params.privKey=$(document.getElementById("var["+paramsKey+".privkey]")).val();akeeba.Configuration.SftpBrowser.params.pubKey=$(document.getElementById("var["+paramsKey+".pubkey]")).val();akeeba.Configuration.SftpBrowser.params.key=key;akeeba.Configuration.SftpBrowser.open()};akeeba.Configuration.SftpBrowser.open=function(){var ftp_dialog_element=$("#sftpdialog");ftp_dialog_element.css("display","block");$("#sftpdialogOkButton").click(function(e){akeeba.Configuration.SftpBrowser.callback(akeeba.Configuration.SftpBrowser.params.directory);$("#sftpdialog").modal("hide")});$("#sftpdialog").modal("show");$("#sftpBrowserErrorContainer").css("display","none");$("#sftpBrowserFolderList").html("");$("#sftpBrowserCrumbs").html("");akeeba.System.params.AjaxURL=akeeba.Configuration.URLs.sftpBrowser;if(empty(akeeba.Configuration.SftpBrowser.params.directory)){akeeba.Configuration.SftpBrowser.params.directory=""}var data={host:akeeba.Configuration.SftpBrowser.params.host,port:akeeba.Configuration.SftpBrowser.params.port,username:akeeba.Configuration.SftpBrowser.params.username,password:akeeba.Configuration.SftpBrowser.params.password,directory:akeeba.Configuration.SftpBrowser.params.directory,privkey:akeeba.Configuration.SftpBrowser.params.privKey,pubkey:akeeba.Configuration.SftpBrowser.params.pubKey};akeeba.System.doAjax(data,function(data){if(data.error!=false){$("#sftpBrowserError").html(data.error);$("#sftpBrowserErrorContainer").css("display","block");$("#sftpBrowserFolderList").css("display","none");$("#ak_scrumbs").css("display","none")}else{$("#ftpBrowserErrorContainer").css("display","none");if(!empty(data.breadcrumbs)){$("#ak_scrumbs").css("display","block");$("#ak_scrumbs").html("");var relativePath="/";akeeba.Configuration.FtpBrowser.addCrumb(Joomla.JText._("COM_AKEEBA_FILEFILTERS_LABEL_UIROOT"),"/",$("#ak_scrumbs"),akeeba.Configuration.SftpBrowser);$.each(data.breadcrumbs,function(i,crumb){relativePath+="/"+crumb;akeeba.Configuration.FtpBrowser.addCrumb(crumb,relativePath,$("#ak_scrumbs"),akeeba.Configuration.SftpBrowser)})}else{$("#sftpBrowserCrumbs").css("display","none")}if(!empty(data.list)){$("#sftpBrowserFolderList").css("display","block");if(!akeeba.Configuration.SftpBrowser.params.directory){akeeba.Configuration.SftpBrowser.params.directory=data.directory}$.each(data.list,function(i,item){akeeba.Configuration.FtpBrowser.createLink(data.directory+"/"+item,item,$("#sftpBrowserFolderList"),akeeba.Configuration.SftpBrowser)})}else{$("#sftpBrowserFolderList").css("display","none")}}},function(message){$("#sftpBrowserError").html(message);$("#sftpBrowserErrorContainer").css("display","block");$("#sftpBrowserFolderList").css("display","none");$("#sftpBrowserCrumbs").css("display","none")},false)};akeeba.Configuration.SftpBrowser.callback=function(path){var charlist=("/").replace(/([\[\]\(\)\.\?\/\*\{\}\+\$\^\:])/g,"$1");var re=new RegExp("^["+charlist+"]+","g");path="/"+(path+"").replace(re,"");$(document.getElementById("var["+akeeba.Configuration.SftpBrowser.params.key+"]")).val(path)};akeeba.Configuration.FtpTest.testConnection=function(buttonKey,configKey){var button=$(document.getElementById(buttonKey));akeeba.Configuration.FtpTest.buttonKey=buttonKey;button.attr("disabled","disabled");var data={host:$(document.getElementById("var["+configKey+".host]")).val(),port:$(document.getElementById("var["+configKey+".port]")).val(),user:$(document.getElementById("var["+configKey+".user]")).val(),pass:$(document.getElementById("var["+configKey+".pass]")).val(),initdir:$(document.getElementById("var["+configKey+".initial_directory]")).val(),usessl:$(document.getElementById("var["+configKey+".ftps]")).is(":checked"),passive:$(document.getElementById("var["+configKey+".passive_mode]")).is(":checked")};akeeba.System.params.AjaxURL=akeeba.Configuration.URLs.testFtp;akeeba.System.doAjax(data,function(res){var button=$(document.getElementById(akeeba.Configuration.FtpTest.buttonKey));button.removeAttr("disabled");$("#testFtpDialogBodyOk").css("display","none");$("#testFtpDialogBodyFail").css("display","none");if(res===true){$("#testFtpDialogLabel").html(Joomla.JText._("COM_AKEEBA_CONFIG_DIRECTFTP_TEST_OK"));$("#testFtpDialogBodyOk").html(Joomla.JText._("COM_AKEEBA_CONFIG_DIRECTFTP_TEST_OK"));$("#testFtpDialogBodyOk").css("display","block");$("#testFtpDialogBodyFail").css("display","none")}else{$("#testFtpDialogLabel").html(Joomla.JText._("COM_AKEEBA_CONFIG_DIRECTFTP_TEST_FAIL"));$("#testFtpDialogBodyFail").html(res);$("#testFtpDialogBodyOk").css("display","none");$("#testFtpDialogBodyFail").css("display","block")}if($("#testFtpDialog > div > div").length==0){$("#testFtpDialog").clone().attr("id","testFtpDialogClone").css("display","block").appendTo($("body"));SqueezeBox.open(document.getElementById("testFtpDialogClone"),{handler:"adopt",size:{x:400,y:300}})}else{$("#testFtpDialog").modal("show")}},null,false,15000)};akeeba.Configuration.SftpTest.testConnection=function(buttonKey,configKey){var button=$(document.getElementById(buttonKey));akeeba.Configuration.SftpTest.buttonKey=buttonKey;button.attr("disabled","disabled");var data={host:$(document.getElementById("var["+configKey+".host]")).val(),port:$(document.getElementById("var["+configKey+".port]")).val(),user:$(document.getElementById("var["+configKey+".user]")).val(),pass:$(document.getElementById("var["+configKey+".pass]")).val(),initdir:$(document.getElementById("var["+configKey+".initial_directory]")).val(),privkey:$(document.getElementById("var["+configKey+".privkey]")).val(),pubkey:$(document.getElementById("var["+configKey+".pubkey]")).val()};akeeba.System.params.AjaxURL=akeeba.Configuration.URLs.testSftp;akeeba.System.doAjax(data,function(res){var button=$(document.getElementById(akeeba.Configuration.SftpTest.buttonKey));button.removeAttr("disabled");$("#testFtpDialogBodyOk").css("display","none");$("#testFtpDialogBodyFail").css("display","none");if(res===true){$("#testFtpDialogLabel").html(Joomla.JText._("COM_AKEEBA_CONFIG_DIRECTSFTP_TEST_OK"));$("#testFtpDialogBodyOk").html(Joomla.JText._("COM_AKEEBA_CONFIG_DIRECTSFTP_TEST_OK"));$("#testFtpDialogBodyOk").css("display","block");$("#testFtpDialogBodyFail").css("display","none")}else{$("#testFtpDialogLabel").html(Joomla.JText._("COM_AKEEBA_CONFIG_DIRECTSFTP_TEST_FAIL"));$("#testFtpDialogBodyFail").html(res);$("#testFtpDialogBodyOk").css("display","none");$("#testFtpDialogBodyFail").css("display","block")}if($("#testFtpDialog > div > div").length==0){$("#testFtpDialog").clone().attr("id","testFtpDialogClone").css("display","block").appendTo($("body"));SqueezeBox.open(document.getElementById("testFtpDialogClone"),{handler:"adopt",size:{x:400,y:300}})}else{$("#testFtpDialog").modal("show")}},null,false,15000)};akeeba.Configuration.enablePopoverFor=function($e){$e.popover({trigger:"manual",animate:false,html:true,placement:"bottom",template:'<div class="popover akeeba-bootstrap-popover" onmouseover="akeeba.jQuery(this).mouseleave(function() {akeeba.jQuery(this).hide(); });"><div class="arrow"></div><div class="popover-inner"><h3 class="popover-title"></h3><div class="popover-content"><p></p></div></div></div>'}).click(function(e){e.preventDefault();var $this=akeeba.jQuery(this);if($this.data("no-popup-close")==1){$this.data("no-popup-close",0);return}$this.data("no-popup-close",1)}).mouseenter(function(e){e.preventDefault();akeeba.jQuery(this).popover("show")}).mouseleave(function(e){e.preventDefault();var $this=akeeba.jQuery(this);if($this.data("no-popup-close")==1){return}$this.popover("hide")})};akeeba_directftp_init_browser=function(){akeeba.Configuration.FtpBrowser.initialise("engine.archiver.directftp.initial_directory","engine.archiver.directftp")};akeeba_postprocftp_init_browser=function(){akeeba.Configuration.FtpBrowser.initialise("engine.postproc.ftp.initial_directory","engine.postproc.ftp")};akeeba_directsftp_init_browser=function(){akeeba.Configuration.SftpBrowser.initialise("engine.archiver.directsftp.initial_directory","engine.archiver.directsftp")};akeeba_postprocsftp_init_browser=function(){akeeba.Configuration.FtpBrowser.initialise("engine.postproc.sftp.initial_directory","engine.postproc.sftp")};directftp_test_connection=function(){akeeba.Configuration.FtpTest.testConnection("engine.archiver.directftp.ftp_test","engine.archiver.directftp")};postprocftp_test_connection=function(){akeeba.Configuration.FtpTest.testConnection("engine.postproc.ftp.ftp_test","engine.postproc.ftp")};directftpcurl_test_connection=function(){akeeba.Configuration.FtpTest.testConnection("engine.archiver.directftpcurl.ftp_test","engine.archiver.directftpcurl")};postprocftpcurl_test_connection=function(){akeeba.Configuration.FtpTest.testConnection("engine.postproc.ftpcurl.ftp_test","engine.postproc.ftpcurl")};directsftp_test_connection=function(){akeeba.Configuration.SftpTest.testConnection("engine.archiver.directsftp.sftp_test","engine.archiver.directsftp")};postprocsftp_test_connection=function(){akeeba.Configuration.SftpTest.testConnection("engine.postproc.sftp.sftp_test","engine.postproc.sftp")};directsftpcurl_test_connection=function(){akeeba.Configuration.SftpTest.testConnection("engine.archiver.directsftpcurl.sftp_test","engine.archiver.directsftpcurl")};postprocsftpcurl_test_connection=function(){akeeba.Configuration.SftpTest.testConnection("engine.postproc.sftpcurl.sftp_test","engine.postproc.sftpcurl")};akconfig_dropbox_openoauth=function(){var url=akeeba.Configuration.URLs.dpeauthopen;if(url.indexOf("?")==-1){url=url+"?"}else{url=url+"&"}window.open(url+"engine=dropbox","akeeba_dropbox_window","width=1010,height=500")};akconfig_dropbox_gettoken=function(){akeeba.System.AjaxURL=akeeba.Configuration.URLs.dpecustomapi;var data={engine:"dropbox",method:"getauth"};akeeba.System.doAjax(data,function(res){if(res.error!=""){alert("ERROR: Could not complete authentication; please retry")}else{$(document.getElementById("var[engine.postproc.dropbox.token]")).val(res.token.oauth_token);$(document.getElementById("var[engine.postproc.dropbox.token_secret]")).val(res.token.oauth_token_secret);$(document.getElementById("var[engine.postproc.dropbox.uid]")).val(res.token.uid);alert("Authentication successful!")}},function(errorMessage){alert("ERROR: Could not complete authentication; please retry\n"+errorMessage)},false,15000)};akconfig_dropbox2_openoauth=function(){var url=akeeba.Configuration.URLs.dpeauthopen;if(url.indexOf("?")==-1){url=url+"?"}else{url=url+"&"}window.open(url+"engine=dropbox2","akeeba_dropbox2_window","width=1010,height=500")};akeeba_dropbox2_oauth_callback=function(data){$(document.getElementById("var[engine.postproc.dropbox2.access_token]")).val(data.access_token);myWindow=window.open("","akeeba_dropbox2_window");myWindow.close()};akconfig_onedrive_openoauth=function(){var url=akeeba.Configuration.URLs.dpeauthopen;if(url.indexOf("?")==-1){url=url+"?"}else{url=url+"&"}window.open(url+"engine=onedrive","akeeba_onedrive_window","width=1010,height=500")};akeeba_onedrive_oauth_callback=function(data){$(document.getElementById("var[engine.postproc.onedrive.access_token]")).val(data.access_token);$(document.getElementById("var[engine.postproc.onedrive.refresh_token]")).val(data.refresh_token);myWindow=window.open("","akeeba_onedrive_window");myWindow.close()};akconfig_googledrive_openoauth=function(){var url=akeeba.Configuration.URLs.dpeauthopen;if(url.indexOf("?")==-1){url=url+"?"}else{url=url+"&"}window.open(url+"engine=googledrive","akeeba_googledrive_window","width=1010,height=500")};akeeba_googledrive_oauth_callback=function(data){$(document.getElementById("var[engine.postproc.googledrive.access_token]")).val(data.access_token);$(document.getElementById("var[engine.postproc.googledrive.refresh_token]")).val(data.refresh_token);myWindow=window.open("","akeeba_googledrive_window");myWindow.close()}}(akeeba.jQuery));