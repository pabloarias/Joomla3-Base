/*
 Copyright (c)2006-2018 Nicholas K. Dionysopoulos / Akeeba Ltd
 @license   GNU General Public License version 3, or later
*/
if("undefined"==typeof akeeba)var akeeba={};"undefined"==typeof akeeba.Transfer&&(akeeba.Transfer={lastUrl:"",lastResult:"",FtpBrowser:{params:{}},SftpBrowser:{params:{}},FtpTest:{},SftpTest:{},FtpModal:null,URLs:{}});
akeeba.Transfer.onUrlChange=function(a){void 0==a&&(a=!1);var d=document.getElementById("akeeba-transfer-url"),b=d.value;""==b&&(document.getElementById("akeeba-transfer-lbl-url").style.display="block");"http://"!=b.substring(0,7)&&"https://"!=b.substring(0,8)&&(b="http://"+b);if(!a&&b==akeeba.Transfer.lastUrl)akeeba.Transfer.applyUrlCheck({status:akeeba.Transfer.lastResult,url:akeeba.Transfer.lastUrl});else{a=document.querySelectorAll("#akeeba-transfer-row-url > div");for(i=0;i<a.length;i++)a[i].style.display=
"none";d.setAttribute("disabled","disabled");document.getElementById("akeeba-transfer-btn-url").setAttribute("disabled","disabled");document.getElementById("akeeba-transfer-loading").style.display="inline-block";akeeba.System.doAjax({task:"checkUrl",url:b},akeeba.Transfer.applyUrlCheck,function(a){d.removeAttribute("disabled");document.getElementById("akeeba-transfer-btn-url").removeAttribute("disabled");document.getElementById("akeeba-transfer-loading").style.display="none"},!1,1E4);return!1}};
akeeba.Transfer.applyUrlCheck=function(a){var d=document.getElementById("akeeba-transfer-url");d.removeAttribute("disabled");document.getElementById("akeeba-transfer-btn-url").removeAttribute("disabled");document.getElementById("akeeba-transfer-loading").style.display="none";document.getElementById("akeeba-transfer-ftp-container").style.display="none";d.value=a.url;akeeba.Transfer.lastResult=a.status;akeeba.Transfer.lastUrl=a.url;switch(a.status){case "ok":akeeba.Transfer.showConnectionDetails();
break;case "same":document.getElementById("akeeba-transfer-err-url-same").style.display="block";break;case "invalid":document.getElementById("akeeba-transfer-err-url-invalid").style.display="block";break;case "notexists":document.getElementById("akeeba-transfer-err-url-notexists").style.display="block"}};
akeeba.Transfer.showConnectionDetails=function(){document.getElementById("akeeba-transfer-url").setAttribute("disabled","disabled");document.getElementById("akeeba-transfer-btn-url").setAttribute("disabled","disabled");document.getElementById("akeeba-transfer-err-url-notexists").style.display="none";document.getElementById("akeeba-transfer-ftp-container").style.display="grid";akeeba.Transfer.onTransferMethodChange();return!1};
akeeba.Transfer.onTransferMethodChange=function(a){a=document.getElementById("akeeba-transfer-ftp-method");a=a.options[a.selectedIndex].value;document.getElementById("akeeba-transfer-ftp-host").parentNode.style.display="none";document.getElementById("akeeba-transfer-ftp-port").parentNode.style.display="none";document.getElementById("akeeba-transfer-ftp-username").parentNode.style.display="none";document.getElementById("akeeba-transfer-ftp-password").parentNode.style.display="none";document.getElementById("akeeba-transfer-ftp-pubkey").parentNode.style.display=
"none";document.getElementById("akeeba-transfer-ftp-privatekey").parentNode.style.display="none";document.getElementById("akeeba-transfer-ftp-directory").parentNode.style.display="none";document.getElementById("akeeba-transfer-ftp-passive-container").style.display="none";document.getElementById("akeeba-transfer-ftp-passive-fix-container").style.display="none";document.getElementById("akeeba-transfer-apply-loading").style.display="none";"manual"!=a&&(document.getElementById("akeeba-transfer-ftp-host").parentNode.style.display=
"grid",document.getElementById("akeeba-transfer-ftp-port").parentNode.style.display="grid",document.getElementById("akeeba-transfer-ftp-username").parentNode.style.display="grid",document.getElementById("akeeba-transfer-ftp-password").parentNode.style.display="grid",document.getElementById("akeeba-transfer-ftp-directory").parentNode.style.display="grid");if("ftp"==a||"ftps"==a||"ftpcurl"==a||"ftpscurl"==a)document.getElementById("akeeba-transfer-ftp-passive-container").style.display="grid";if("ftpcurl"==
a||"ftpscurl"==a)document.getElementById("akeeba-transfer-ftp-passive-fix-container").style.display="grid";if("sftp"==a||"sftpcurl"==a)document.getElementById("akeeba-transfer-ftp-pubkey").parentNode.style.display="grid",document.getElementById("akeeba-transfer-ftp-privatekey").parentNode.style.display="grid"};
akeeba.Transfer.FtpBrowser.initialise=function(){var a=document.getElementById("akeeba-transfer-ftp-method");akeeba.Transfer.FtpBrowser.params.host=document.getElementById("akeeba-transfer-ftp-host").value;akeeba.Transfer.FtpBrowser.params.port=document.getElementById("akeeba-transfer-ftp-port").value;akeeba.Transfer.FtpBrowser.params.username=document.getElementById("akeeba-transfer-ftp-username").value;akeeba.Transfer.FtpBrowser.params.password=document.getElementById("akeeba-transfer-ftp-password").value;
akeeba.Transfer.FtpBrowser.params.passive=document.getElementById("akeeba-transfer-ftp-passive1").checked?1:0;akeeba.Transfer.FtpBrowser.params.passive_fix=document.getElementById("akeeba-transfer-ftp-passive-fix1").checked?1:0;akeeba.Transfer.FtpBrowser.params.ssl="ftps"==a.options[a.selectedIndex].value?1:0;akeeba.Transfer.FtpBrowser.params.directory=document.getElementById("akeeba-transfer-ftp-directory").value;akeeba.Transfer.FtpBrowser.open()};
akeeba.Transfer.FtpBrowser.open=function(){var a=document.getElementById("ftpdialog");a.css("display","block");a.removeClass("ui-state-error");akeeba.System.addEventListener(document.getElementById("ftpdialogOkButton"),"click",function(a){akeeba.Transfer.FtpBrowser.callback(akeeba.Transfer.FtpBrowser.params.directory);"object"==typeof akeeba.Transfer.FtpModal&&akeeba.Transfer.FtpModal.close&&akeeba.Transfer.FtpModal.close()});akeeba.System.addEventListener(document.getElementById("ftpdialogCancelButton"),
"click",function(a){"object"==typeof akeeba.Transfer.FtpModal&&akeeba.Transfer.FtpModal.close&&akeeba.Transfer.FtpModal.close()});akeeba.Transfer.FtpModal=akeeba.Modal.open({inherit:a,width:"80%"});document.getElementById("ftpBrowserErrorContainer").style.display="none";document.getElementById("ftpBrowserFolderList").innerHTML="";document.getElementById("ftpBrowserCrumbs").innerHTML="";empty(akeeba.Transfer.FtpBrowser.params.directory)&&(akeeba.Transfer.FtpBrowser.params.directory="");akeeba.System.doAjax({view:"FTPBrowser",
task:"browse",host:akeeba.Transfer.FtpBrowser.params.host,port:akeeba.Transfer.FtpBrowser.params.port,username:akeeba.Transfer.FtpBrowser.params.username,password:akeeba.Transfer.FtpBrowser.params.password,passive:akeeba.Transfer.FtpBrowser.params.passive?1:0,ssl:akeeba.Transfer.FtpBrowser.params.ssl?1:0,directory:akeeba.Transfer.FtpBrowser.params.directory},function(a){var b=document.getElementById("ak_crumbs2");if(!1!=a.error)document.getElementById("ftpBrowserError").innerHTML=a.error,document.getElementById("ftpBrowserErrorContainer").style.display=
"block",document.getElementById("ftpBrowserFolderList").style.display="none",document.getElementById("ftpBrowserWrapper").style.display="none",b.style.display="none";else{document.getElementById("ftpBrowserErrorContainer").style.display="none";document.getElementById("ftpBrowserWrapper").style.display="block";if(empty(a.breadcrumbs))document.getElementById("ftpBrowserCrumbs").style.display="none";else{b.style.display="block";b.innerHTML="";var c="/";akeeba.Transfer.FtpBrowser.addCrumb(Joomla.JText._("COM_AKEEBA_FILEFILTERS_LABEL_UIROOT"),
"/",b);for(i=0;i<a.breadcrumbs.length;i++)b=a.breadcrumbs[i],c+="/"+b,akeeba.Transfer.FtpBrowser.addCrumb(b,c,document.getElementById("ak_crumbs2"))}if(empty(a.list))document.getElementById("ftpBrowserFolderList").style.display="none";else{document.getElementById("ftpBrowserFolderList").style.display="block";akeeba.Transfer.FtpBrowser.params.directory||(akeeba.Transfer.FtpBrowser.params.directory=a.directory);for(i=0;i<a.list.length;i++)c=a.list[i],akeeba.Transfer.FtpBrowser.createLink(a.directory+
"/"+c,c,document.getElementById("ftpBrowserFolderList"))}}},function(a){document.getElementById("ftpBrowserError").innerHTML=a;document.getElementById("ftpBrowserErrorContainer").style.display="block";document.getElementById("ftpBrowserFolderList").style.display="none";document.getElementById("ftpBrowserCrumbs").style.display="none";document.getElementById("ftpBrowserWrapper").style.display="none"},!1)};
akeeba.Transfer.FtpBrowser.createLink=function(a,d,b,c){"undefined"==typeof c&&(c=akeeba.Transfer.FtpBrowser);var e=document.createElement("tr"),g=document.createElement("td");e.appendChild(g);var f=document.createElement("a");f.textContent=d;akeeba.System.addEventListener(f,"click",function(){c.params.directory=a;c.open()});g.appendChild(f);b.appendChild(e)};
akeeba.Transfer.FtpBrowser.addCrumb=function(a,d,b,c){"undefined"==typeof c&&(c=akeeba.Transfer.FtpBrowser);var e=document.createElement("li"),g=document.createElement("a");g.innerHTML=a;akeeba.System.addEventListener(g,"click",function(a){c.params.directory=d;c.open();a.preventDefault?a.preventDefault():a.returnValue=!1});e.appendChild(g);a=document.createElement("span");a.className="divider";a.textContent="/";e.appendChild(a);e.appendTo(b)};
akeeba.Transfer.SftpBrowser.initialise=function(){akeeba.Transfer.SftpBrowser.params.host=document.getElementById("akeeba-transfer-ftp-host").value;akeeba.Transfer.SftpBrowser.params.port=document.getElementById("akeeba-transfer-ftp-port").value;akeeba.Transfer.SftpBrowser.params.username=document.getElementById("akeeba-transfer-ftp-username").value;akeeba.Transfer.SftpBrowser.params.password=document.getElementById("akeeba-transfer-ftp-password").value;akeeba.Transfer.SftpBrowser.params.directory=
document.getElementById("akeeba-transfer-ftp-directory").value;akeeba.Transfer.SftpBrowser.params.privKey=document.getElementById("akeeba-transfer-ftp-privatekey").value;akeeba.Transfer.SftpBrowser.params.pubKey=document.getElementById("akeeba-transfer-ftp-pubkey").value;akeeba.Transfer.SftpBrowser.open()};
akeeba.Transfer.SftpBrowser.open=function(){var a=document.getElementById("sftpdialog");a.style.display="block";akeeba.System.removeClass(a,"ui-state-error");akeeba.System.addEventListener(document.getElementById("sftpdialogOkButton"),"click",function(a){akeeba.Transfer.FtpBrowser.callback(akeeba.Transfer.SftpBrowser.params.directory);"object"==typeof akeeba.Transfer.FtpModal&&akeeba.Transfer.FtpModal.close&&akeeba.Transfer.FtpModal.close()});akeeba.System.addEventListener(document.getElementById("sftpdialogCancelButton"),
"click",function(a){"object"==typeof akeeba.Transfer.FtpModal&&akeeba.Transfer.FtpModal.close&&akeeba.Transfer.FtpModal.close()});akeeba.Transfer.FtpModal=akeeba.Modal.open({inherit:a,width:"80%"});document.getElementById("sftpBrowserErrorContainer").style.display="none";document.getElementById("sftpBrowserFolderList").innerHTML="";document.getElementById("sftpBrowserCrumbs").innerHTML="";akeeba.System.doAjax({view:"SFTPBrowser",task:"browse",host:akeeba.Transfer.SftpBrowser.params.host,port:akeeba.Transfer.SftpBrowser.params.port,
username:akeeba.Transfer.SftpBrowser.params.username,password:akeeba.Transfer.SftpBrowser.params.password,directory:akeeba.Transfer.SftpBrowser.params.directory,privkey:akeeba.Transfer.SftpBrowser.params.privKey,pubkey:akeeba.Transfer.SftpBrowser.params.pubKey},function(a){var b=document.getElementById("ak_scrumbs");if(!1!=a.error)document.getElementById("sftpBrowserError").innerHTML=a.error,document.getElementById("sftpBrowserErrorContainer").style.display="block",document.getElementById("sftpBrowserFolderList").style.display=
"none",document.getElementById("sftpBrowserWrapper").style.display="none",b.style.display="none";else{document.getElementById("ftpBrowserErrorContainer").style.display="none";document.getElementById("sftpBrowserWrapper").style.display="block";if(empty(a.breadcrumbs))document.getElementById("sftpBrowserCrumbs").style.display="none";else{b.css("display","block");b.html("");var c="/";akeeba.Transfer.FtpBrowser.addCrumb(Joomla.JText._("COM_AKEEBA_FILEFILTERS_LABEL_UIROOT"),"/",b,akeeba.Transfer.SftpBrowser);
for(i=0;i<a.breadcrumbs.length;i++)b=a.breadcrumbs[i],c+="/"+b,akeeba.Transfer.FtpBrowser.addCrumb(b,c,document.getElementById("ak_scrumbs"),akeeba.Transfer.SftpBrowser)}if(empty(a.list))document.getElementById("sftpBrowserFolderList").style.display="none";else{document.getElementById("sftpBrowserFolderList").style.display="block";akeeba.Transfer.SftpBrowser.params.directory||(akeeba.Transfer.SftpBrowser.params.directory=a.directory);for(i=0;i<a.list.length;i++)c=a.list[i],akeeba.Transfer.FtpBrowser.createLink(a.directory+
"/"+c,c,document.getElementById("sftpBrowserFolderList"),akeeba.Transfer.SftpBrowser)}}},function(a){document.getElementById("sftpBrowserError").innerHTML=a;document.getElementById("sftpBrowserErrorContainer").style.display="block";document.getElementById("sftpBrowserFolderList").style.display="none";document.getElementById("sftpBrowserCrumbs").style.display="none";document.getElementById("sftpBrowserWrapper").style.display="none"},!1)};
akeeba.Transfer.applyConnection=function(){document.getElementById("akeeba-transfer-ftp-error").style.display="none";document.getElementById("akeeba-transfer-apply-loading").style.display="grid";document.getElementById("akeeba-transfer-btn-apply").setAttribute("disabled","disabled");document.getElementById("akeeba-transfer-ftp-method").setAttribute("disabled","disabled");document.getElementById("akeeba-transfer-ftp-host").parentNode.style.display="none";document.getElementById("akeeba-transfer-ftp-port").parentNode.style.display=
"none";document.getElementById("akeeba-transfer-ftp-username").parentNode.style.display="none";document.getElementById("akeeba-transfer-ftp-password").parentNode.style.display="none";document.getElementById("akeeba-transfer-ftp-pubkey").parentNode.style.display="none";document.getElementById("akeeba-transfer-ftp-privatekey").parentNode.style.display="none";document.getElementById("akeeba-transfer-ftp-directory").parentNode.style.display="none";document.getElementById("akeeba-transfer-ftp-passive-container").style.display=
"none";document.getElementById("akeeba-transfer-ftp-passive-fix-container").style.display="none";var a=document.getElementById("akeeba-transfer-ftp-method"),a=a.options[a.selectedIndex].value;"manual"===a?(document.getElementById("akeeba-transfer-apply-loading").style.display="none",document.getElementById("akeeba-transfer-btn-apply").parentNode.style.display="none",document.getElementById("akeeba-transfer-manualtransfer").style.display="block"):(a={task:"applyConnection",method:a,host:document.getElementById("akeeba-transfer-ftp-host").value,
port:document.getElementById("akeeba-transfer-ftp-port").value,username:document.getElementById("akeeba-transfer-ftp-username").value,password:document.getElementById("akeeba-transfer-ftp-password").value,directory:document.getElementById("akeeba-transfer-ftp-directory").value,passive:document.getElementById("akeeba-transfer-ftp-passive1").checked?1:0,passive_fix:document.getElementById("akeeba-transfer-ftp-passive-fix1").checked?1:0,"private":document.getElementById("akeeba-transfer-ftp-privatekey").value,
"public":document.getElementById("akeeba-transfer-ftp-pubkey").value},akeeba.System.doAjax(a,function(a){document.getElementById("akeeba-transfer-apply-loading").style.display="none";if(a.status)akeeba.Transfer.uploadKickstart();else{document.getElementById("akeeba-transfer-btn-apply").removeAttribute("disabled");document.getElementById("akeeba-transfer-ftp-method").removeAttribute("disabled");var b=document.getElementById("akeeba-transfer-ftp-error"),c=document.getElementById("akeeba-transfer-ftp-error-body"),
e=document.getElementById("akeeba-transfer-ftp-error-force");e&&(e.style.display="none",a.ignorable&&(e.style.display="inline-block"));c.innerHTML=a.message;b.style.display="block";akeeba.System.triggerEvent(b,"focus");akeeba.Transfer.onTransferMethodChange()}},function(a){document.getElementById("akeeba-transfer-apply-loading").style.display="none";document.getElementById("akeeba-transfer-btn-apply").removeAttribute("disabled");document.getElementById("akeeba-transfer-ftp-method").removeAttribute("disabled");
a=document.getElementById("akeeba-transfer-ftp-error");document.getElementById("akeeba-transfer-ftp-error-body").textContent=Joomla.JText._("COM_AKEEBA_CONFIG_DIRECTFTP_TEST_FAIL");a.style.display="block";akeeba.System.triggerEvent(a,"focus");akeeba.Transfer.onTransferMethodChange()},!1,15E3))};
akeeba.Transfer.uploadKickstart=function(){var a=document.getElementById("akeeba-transfer-upload-lbl-kickstart"),d=document.getElementById("akeeba-transfer-upload-lbl-archive"),b=document.getElementById("akeeba-transfer-upload-error");b.style.display="none";akeeba.System.removeClass(a,"label-default label-success label-important");akeeba.System.addClass(a,"label-warning");akeeba.System.removeClass(d,"label-success label-important label-warning");akeeba.System.addClass(d,"label-default");document.getElementById("akeeba-transfer-upload-area-kickstart").style.display=
"none";document.getElementById("akeeba-transfer-upload-area-upload").style.display="block";document.getElementById("akeeba-transfer-upload").style.display="block";akeeba.System.doAjax({task:"initialiseUpload"},function(c){c.status?akeeba.Transfer.uploadArchive(1):(akeeba.System.addClass(a,"label-important"),akeeba.System.removeClass(a,"label-warning"),b.innerHTML=c.message,b.style.display="block")},null,!1,15E4)};
akeeba.Transfer.uploadArchive=function(a){void 0==a&&(a=0);var d=document.getElementById("akeeba-transfer-upload-lbl-kickstart"),b=document.getElementById("akeeba-transfer-upload-lbl-archive"),c=document.getElementById("akeeba-transfer-upload-error");c.style.display="none";akeeba.System.removeClass(d,"label-default label-important label-warning");akeeba.System.addClass(d,"label-success");akeeba.System.removeClass(b,"label-default label-success label-important");akeeba.System.addClass(b,"label-warning");
akeeba.System.doAjax({task:"upload",start:a},function(a){if(a.result)if(a.done){document.getElementById("akeeba-transfer-upload-percent").textContent="100 %";document.getElementById("akeeba-transfer-upload-size").innerHTML="";var d=document.getElementById("akeeba-transfer-url").value.replace(/\/$/,"")+"/kickstart.php";document.getElementById("akeeba-transfer-upload-area-kickstart").style.display="block";document.getElementById("akeeba-transfer-upload-area-upload").style.display="none";document.getElementById("akeeba-transfer-upload-btn-kickstart").setAttribute("href",
d)}else{var d=0,f=1*a.totalSize;a=1*a.doneSize;0<f&&0<a&&(d=100*(a/f));document.getElementById("akeeba-transfer-upload-percent").textContent=d.toFixed(2)+"%";document.getElementById("akeeba-transfer-upload-size").textContent=a.toFixed(0)+" / "+f.toFixed(0)+" bytes";window.setTimeout(function(){akeeba.Transfer.uploadArchive(0)},50)}else akeeba.System.removeClass(b,"label-warning"),akeeba.System.addClass(b,"label-important"),c.innerHTML=a.message,c.style.display="block"},null,!1,15E4)};
akeeba.Transfer.initFtpSftpBrowser=function(){var a=document.getElementById("akeeba-transfer-ftp-method"),a=a.options[a.selectedIndex].value;"ftp"==a||"ftps"==a||"ftpcurl"==a||"ftpscurl"==a?akeeba.Transfer.FtpBrowser.initialise():("sftp"==a||"sftpcurl"==a)&&akeeba.Transfer.SftpBrowser.initialise();return!1};
akeeba.Transfer.testFtpSftpConnection=function(){var a=document.getElementById("akeeba-transfer-ftp-method"),a=a.options[a.selectedIndex].value;"ftp"==a||"ftps"==a||"ftpcurl"==a||"ftpscurl"==a?akeeba.Transfer.FtpTest.testConnection("akeeba-transfer-btn-testftp"):("sftp"==a||"sftpcurl"==a)&&akeeba.Transfer.SftpTest.testConnection("akeeba-transfer-btn-testftp");return!1};
akeeba.Transfer.FtpBrowser.callback=function(a){"//"==a.substring(0,2)&&(a=a.substring(1));document.getElementById("akeeba-transfer-ftp-directory").value=a};akeeba.System.documentReady(function(){akeeba.System.addEventListener(document.getElementById("akeeba-transfer-ftp-method"),"change",akeeba.Transfer.onTransferMethodChange)}); //# sourceMappingURL=Transfer.min.map
