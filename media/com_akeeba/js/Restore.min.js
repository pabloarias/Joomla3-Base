if(typeof akeeba=="undefined"){var akeeba={}}if(typeof akeeba.Restore=="undefined"){akeeba.Restore={lastResponseSeconds:0,timer:0,errorCallback:null,statistics:{inbytes:0,outbytes:0,files:0},factory:null,password:null,ajaxURL:null,mainURL:null}}akeeba.Restore.errorCallbackDefault=function(a){document.getElementById("restoration-progress").style.display="none";document.getElementById("restoration-error").style.display="block";document.getElementById("backup-error-message").innerHTML=a};akeeba.Restore.doAjax=function(f,a,c){json=JSON.stringify(f);var g={json:json};if(akeeba.Restore.password.length>0){g.password=akeeba.Restore.password}var d=new Date().getTime()/1000;var e=parseInt(d,10);g._cacheBustingJunk=Math.round((d-e)*1000);var b={type:"POST",url:akeeba.Restore.ajaxURL,cache:false,data:g,timeout:600000,success:function(m){var l=null;var j="";var h=m.indexOf("###");if(h==-1){m="Invalid AJAX data: "+m;if(c==null){if(akeeba.Restore.errorCallback!=null){akeeba.Restore.errorCallback(m)}else{akeeba.Restore.errorCallbackDefault(m)}}else{c(m)}return}else{if(h!=0){l=m.substr(0,h);j=m.substr(h)}else{j=m}}j=j.substr(3);h=j.lastIndexOf("###");j=j.substr(0,h);try{var k=JSON.parse(j)}catch(i){errorMessage=i.message+"\n<br/>\n<pre>\n"+j+"\n</pre>";if(c==null){if(akeeba.Restore.errorCallback!=null){akeeba.Restore.errorCallback(errorMessage)}else{akeeba.Restore.errorCallbackDefault(errorMessage)}}else{c(errorMessage)}return}a(k)},error:function(h,l,j){var k=h.responseText?h.responseText:"";var i="<strong>AJAX Loading Error</strong><br/>HTTP Status: "+h.status+" ("+h.statusText+")<br/>";i=i+"Internal status: "+l+"<br/>";i=i+"XHR ReadyState: "+h.readyState+"<br/>";i=i+"Raw server response:<br/>"+akeeba.System.sanitizeErrorMessage(k);if(c==null){if(akeeba.Restore.errorCallback!=null){akeeba.Restore.errorCallback(i)}else{akeeba.Restore.errorCallbackDefault(i)}}else{c(i)}}};akeeba.Ajax.ajax(b)};akeeba.Restore.startTimeoutBar=function(b,a){akeeba.Restore.resetTimeoutBar();akeeba.Restore.timer=setInterval(function(){akeeba.Restore.lastResponseSeconds++;var d=Joomla.JText._("COM_AKEEBA_BACKUP_TEXT_LASTRESPONSE").replace("%s",akeeba.Restore.lastResponseSeconds.toFixed(0));try{document.getElementById("response-timer").querySelector("div.text").textContent=d}catch(c){}},1000)};akeeba.Restore.resetTimeoutBar=function(){akeeba.Restore.lastResponseSeconds=0;if(akeeba.Restore.timer==0){return}clearInterval(akeeba.Restore.timer);akeeba.Restore.timer=0;var a=document.getElementById("response-timer").querySelector("div.text");var c=Joomla.JText._("COM_AKEEBA_BACKUP_TEXT_LASTRESPONSE").replace("%s","0");try{a.textContent=c}catch(b){}};akeeba.Restore.pingRestoration=function(){akeeba.Restore.statistics.inbytes=0;akeeba.Restore.statistics.outbytes=0;akeeba.Restore.statistics.files=0;var a={task:"ping"};akeeba.Restore.startTimeoutBar(5000,80);akeeba.Restore.doAjax(a,function(b){akeeba.Restore.start(b)})};akeeba.Restore.start=function(){akeeba.Restore.statistics.inbytes=0;akeeba.Restore.statistics.outbytes=0;akeeba.Restore.statistics.files=0;var a={task:"startRestore"};akeeba.Restore.startTimeoutBar(5000,80);akeeba.Restore.doAjax(a,function(b){akeeba.Restore.step(b)})};akeeba.Restore.step=function(a){akeeba.Restore.resetTimeoutBar();if(a.status==false){akeeba.Restore.errorCallbackDefault(a.message)}else{if(a.done){akeeba.Restore.factory=a.factory;document.getElementById("restoration-progress").style.display="none";document.getElementById("restoration-extract-ok").style.display="block"}else{akeeba.Restore.statistics.inbytes+=a.bytesIn;akeeba.Restore.statistics.outbytes+=a.bytesOut;akeeba.Restore.statistics.files+=a.files;try{document.getElementById("extbytesin").textContent=akeeba.Restore.statistics.inbytes;document.getElementById("extbytesout").textContent=akeeba.Restore.statistics.outbytes;document.getElementById("extfiles").textContent=akeeba.Restore.statistics.files}catch(b){}post={task:"stepRestore",factory:a.factory};akeeba.Restore.startTimeoutBar(5000,80);akeeba.Restore.doAjax(post,function(c){akeeba.Restore.step(c)})}}};akeeba.Restore.finalize=function(){var a={task:"finalizeRestore",factory:akeeba.Restore.factory};akeeba.Restore.startTimeoutBar(5000,80);akeeba.Restore.doAjax(a,function(b){akeeba.Restore.finished(b)})};akeeba.Restore.finished=function(){window.location=akeeba.Restore.mainURL};akeeba.Restore.runInstaller=function(){window.open("../installation/index.php","abiinstaller");var a=document.getElementById("restoration-runinstaller");var b=document.getElementById("restoration-finalize");a.className="akeeba-btn--grey--small";b.style.display="block"};akeeba.Restore.restoreDefaultOptions=function(){var a=document.getElementById("jps_key");if(a){a.value="ChromeIsDumb";a.value=""}};